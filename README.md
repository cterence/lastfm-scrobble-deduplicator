TODO: choose between inmem cache or redis (create interface)
TODO: timeout when stuck ?
TODO: use flags instead of env vars
